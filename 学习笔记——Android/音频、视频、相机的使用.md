Audio, Video, and Using the Camera



➤使用Media Player和Exoplayer播放音频和视频
➤处理音频焦点
➤使用媒体会话
➤构建媒体控件
➤背景音频播放
➤使用媒体路由器和演员应用程序框架
➤创建媒体样式通知
➤录制音频
➤使用Intents录制视频和拍照
➤预览录制的视频并显示实时摄像机流
➤拍摄照片并直接控制相机
➤在Media Store中添加录制的媒体



介绍用于控制音频和视频录制和回放的Android API，控制设备的音频焦点，以及在其他应用程序时做出适当的反应
取下焦点或更改输出通道（例如，拔下耳机时）。
您还将学习如何使用媒体会话API来传达有关媒体的信息
回放到系统和其他应用程序，以及接收播放，暂停和其他媒体事件
通知，耳机和连接设备，包括Wear OS和Android Auto。
您将学习如何构建音频播放服务，以及如何使UI保持同步
当前的音频状态。您还可以探索生命周期和前景状态的重要性
音频播放，以及如何构建媒体样式通知。

学习使用Android相机API拍摄照片和录制视频，以及如何显示
现场摄像头。



使用媒体播放器，您可以播放存储在应用程序资源，本地文件中的音频和视频，
内容提供商，或从网络URL流式传输。 MediaPlayer类作为一部分提供
所有设备上的Android框架都支持音频和视频播放。



1.使用要播放的媒体初始化媒体播放器。
2.准备媒体播放器以进行播放。
3.开始播放。
4.在完成播放之前暂停或停止播放。
5.播放完成。

有关媒体播放器状态的更详细和详尽的描述
机器在Android开发者网站上提供，位于developer.android.com/
参考/安卓/媒体/ MediaPlayer.html＃StateDiagram



要播放媒体资源，您需要创建一个新的MediaPlayer实例，并使用媒体对其进行初始化
来源，并准备播放。 MediaPlayer包含许多静态创建方法
结合所有这三个步骤。
或者，您可以在现有Media Player实例上使用setDataSource方法
如清单17-1所示。 此方法接受文件路径，Content Provider URI，流媒体
URL路径或文件描述符。
因为准备数据源涉及潜在的昂贵操作，例如获取数据
在网络和解码数据流时，你永远不应该在UI上调用prepare方法
线。 而是设置MediaPlayer.OnPreparedListener并使用prepareAsync来保留您的UI
在准备媒体播放时响应。

```java
MediaPlayer mediaPlayer = new MediaPlayer(); mediaPlayer.setDataSource("http://site.com/audio/mydopetunes.mp3"); mediaPlayer.setOnPreparedListener(myOnPreparedListener); mediaPlayer.prepareAsync();
```

Android支持有限数量的同步Media Player
对象; 不释放它们会在系统运行时导致运行时异常
出。 完成播放后，将释放Media Player对象上的释放以释放
相关资源：
mediaPlayer.release（）;

当媒体播放器完成准备时，将在准备好的侦听器处理程序上关联
触发，您可以调用start开始播放相关媒体：

```java
private MediaPlayer.OnPreparedListener myOnPreparedListener =
 new MediaPlayer.OnPreparedListener() {

 @Override
 public void onPrepared(MediaPlayer mp) {
 mp.start();
 }
};
```

播放开始后，您可以使用媒体播放器的停止和暂停方法来停止播放
分别暂停播放。
媒体播放器还提供getDuration方法来查找媒体的长度
播放并使用getCurrentPosition方法查找播放位置。 使用seekTo方法
跳到媒体的特定位置。

MediaPlayer是一个相对昂贵的对象来创建和维护，
所以你应该避免创建多个实例。 考虑使用SoundPool
如果你需要很多音频流的低延迟播放，那就上课了
常见于具有背景音乐和多种音效的游戏中。

